@import '@garden/tokens';
/* Tailwind base */
@import 'tailwindcss';

@layer components {
  /* Base button */
  [data-ui='button'] {
    @apply inline-flex items-center justify-center select-none;
    @apply px-4 py-2 rounded-2xl text-fg font-medium bg-surface border border-border shadow-card;
    @apply transition-[transform,opacity,background-color,box-shadow] will-change-transform;
  }
  [data-ui='button']:hover {
    opacity: 0.95;
    @apply shadow-pop;
    filter: brightness(1.05) saturate(1.1);
  }
  [data-ui='button']:active {
    transform: translateY(1px);
  }
  [data-ui='button']:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--accent) 70%, white 30%);
  }
  [data-ui='button'][disabled],
  [data-ui='button'][aria-disabled='true'] {
    opacity: 0.5;
    pointer-events: none;
    filter: saturate(0.8);
  }

  /* Tones */
  [data-ui='button'][data-tone='accent'] {
    @apply bg-accent text-on-accent border-border;
  }
  [data-ui='button'][data-tone='accent']:hover {
    @apply shadow-pop;
    filter: brightness(1.1) saturate(1.2);
  }
  [data-ui='button'][data-tone='danger'] {
    @apply bg-danger text-white border-danger;
  }
  [data-ui='button'][data-tone='subtle'] {
    @apply bg-elev text-subtle border-border opacity-90;
  }

  /* Sizes (optional) */
  [data-ui='button'][data-size='lg'] {
    @apply px-5 py-3 text-lg rounded-3xl;
  }
  [data-ui='button'][data-size='sm'] {
    @apply px-3 py-1.5 text-sm rounded-xl;
  }

  /* Icon-only button (square) */
  [data-ui='icon-button'] {
    @apply inline-grid place-items-center size-10 rounded-2xl bg-surface text-fg border border-border shadow-card;
  }
  [data-ui='icon-button']:hover {
    @apply shadow-pop;
  }
  [data-ui='icon-button']:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px var(--ring-accent);
  }
  [data-ui='icon-button'][disabled],
  [data-ui='icon-button'][aria-disabled='true'] {
    opacity: 0.5;
    pointer-events: none;
    filter: saturate(0.8);
  }

  /* ===========================
     Pill / Tag
     ---------------------------
     Usage:
       <span data-ui="pill" data-variant="solid" data-tone="accent">Mark</span>
       data-variant: solid | soft | outline (default: soft)
       data-tone: accent | positive | warning | danger | subtle (default: subtle)
       data-density: snug | cozy (default: cozy)
  ============================*/
  [data-ui='pill'] {
    --_bg: color-mix(in oklab, var(--border) 24%, transparent);
    --_fg: var(--text);
    --_bd: color-mix(in oklab, var(--border) 52%, transparent);
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    border-radius: 9999px;
    border: 1px solid var(--_bd);
    padding: 0.25rem 0.625rem;
    font-size: var(--text-label);
    line-height: var(--text-label--line-height);
    white-space: nowrap;
    transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
    background-color: var(--_bg);
    color: var(--_fg);
  }

  /* density */
  [data-ui='pill'][data-density='snug'] {
    padding: 0.125rem 0.5rem;
  }
  [data-ui='pill'][data-density='cozy'] {
    padding: 0.25rem 0.625rem;
  }

  /* variants */
  [data-ui='pill'][data-variant='solid'] {
    --_bg: var(--accent);
    --_fg: var(--on-accent);
    --_bd: color-mix(in oklab, var(--accent) 70%, black 30%);
  }
  [data-ui='pill'][data-variant='outline'] {
    --_bg: transparent;
    --_fg: var(--text);
    --_bd: color-mix(in oklab, var(--accent) 70%, transparent);
  }
  /* default: soft */
  [data-ui='pill']:not([data-variant]),
  [data-ui='pill'][data-variant='soft'] {
    --_bg: color-mix(in oklab, var(--accent) 14%, var(--surface));
    --_fg: color-mix(in oklab, var(--accent) 80%, var(--text));
    --_bd: color-mix(in oklab, var(--accent) 40%, transparent);
  }

  /* tones */
  [data-ui='pill'][data-tone='accent'] {
    --accent: var(--color-accent);
    --on-accent: var(--color-on-accent);
  }
  [data-ui='pill'][data-tone='positive'] {
    --accent: var(--color-positive);
    --on-accent: oklch(0.16 0 180);
  }
  [data-ui='pill'][data-tone='warning'] {
    --accent: var(--color-warning);
    --on-accent: oklch(0.16 0 80);
  }
  [data-ui='pill'][data-tone='danger'] {
    --accent: var(--color-danger);
    --on-accent: oklch(0.16 0 30);
  }
  [data-ui='pill'][data-tone='subtle'],
  [data-ui='pill']:not([data-tone]) {
    --accent: color-mix(in oklab, var(--text) 16%, var(--border));
    --on-accent: var(--surface);
  }

  /* hover / focus */
  [data-ui='pill']:is(a, button):hover {
    filter: brightness(1.05);
  }
  [data-ui='pill']:is(a, button):active {
    filter: brightness(0.98);
  }
  [data-ui='pill']:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--ring-accent) 70%, transparent);
  }

  /* Optional leading dot glyph */
  [data-ui='pill']::before {
    content: attr(data-dot);
    display: inline-block;
    width: 0.4rem;
    height: 0.4rem;
    border-radius: 9999px;
    background-color: currentColor;
    opacity: 0.5;
    transform: translateY(0.04rem);
  }
  [data-ui='pill']:not([data-dot])::before {
    content: none;
  }

  /* ===========================
     Card / Surface
     ---------------------------
     Usage:
       <section data-ui="card">
         ...
       </section>
       data-variant: base | elev | glow (default: base)
       data-padding: none | sm | md | lg (default: md)
  ============================*/
  [data-ui='card'] {
    --_bg: var(--surface);
    --_bd: var(--border);
    --_shadow: var(--shadow-card);
    background: var(--_bg);
    color: var(--text);
    border: 1px solid var(--_bd);
    border-radius: var(--sheet-radius);
    box-shadow: var(--_shadow);
    position: relative;
  }

  /* padding presets */
  [data-ui='card'][data-padding='none'] {
    padding: 0;
  }
  [data-ui='card']:not([data-padding]),
  [data-ui='card'][data-padding='md'] {
    padding: 1rem;
  }
  [data-ui='card'][data-padding='sm'] {
    padding: 0.75rem;
  }
  [data-ui='card'][data-padding='lg'] {
    padding: 1.25rem;
  }

  /* variants */
  [data-ui='card'][data-variant='elev'] {
    --_shadow: var(--shadow-pop);
  }
  [data-ui='card'][data-variant='glow'] {
    --_shadow: var(--shadow-pop), var(--shadow-aurora);
  }

  /* subtle divider helper inside cards */
  [data-ui='card'] hr {
    border: 0;
    border-top: 1px solid color-mix(in oklab, var(--border) 80%, transparent);
    margin: 0.75rem 0;
  }

  /* ===========================
     Field / Input Group
     ---------------------------
     Usage (DOM shape is flexible):
       <div data-ui="field" data-state="idle|success|warning|error" data-layout="stack|inline">
         <label data-part="label" for="...">Label</label>
         <input data-ui="input" id="..." />
         <p data-part="hint">Short hint</p>
         <p data-part="description">Longer description</p>
         <p data-part="error">Error text</p>
       </div>
  ============================*/
  [data-ui='field'] {
    display: grid;
    gap: 0.375rem;
  }

  /* label */
  [data-ui='field'] [data-part='label'] {
    font-size: var(--text-label);
    line-height: var(--text-label--line-height);
    font-weight: 500;
    color: color-mix(in oklab, var(--text) 78%, transparent);
  }
  [data-ui='field'][data-required='true'] [data-part='label']::after {
    content: ' *';
    color: color-mix(in oklab, var(--color-danger) 70%, var(--text));
    font-weight: 600;
  }
  [data-ui='field'] [data-part='label'][data-required]::after {
    content: 'â€¢';
    opacity: 0.6;
    margin-left: 0.25rem;
    font-weight: normal;
  }

  /* input base (works for input, textarea, select) */
  [data-ui='input'],
  [data-ui='field'] input,
  [data-ui='field'] textarea,
  [data-ui='field'] select {
    appearance: none;
    width: 100%;
    border-radius: var(--control-radius, 0.625rem);
    border: 1px solid var(--border);
    background-color: var(--surface);
    color: var(--text);
    padding: 0.5rem 0.75rem;
    font-size: var(--text-base);
    line-height: var(--text-base--line-height);
    transition: border-color 0.15s ease, background-color 0.15s ease, box-shadow 0.15s ease, filter 0.15s ease;
  }

  [data-ui='input']::placeholder,
  [data-ui='field'] input::placeholder,
  [data-ui='field'] textarea::placeholder {
    color: color-mix(in oklab, var(--text) 48%, transparent);
  }

  /* focus ring */
  [data-ui='input']:focus-visible,
  [data-ui='field'] input:focus-visible,
  [data-ui='field'] textarea:focus-visible,
  [data-ui='field'] select:focus-visible {
    outline: none;
    border-color: color-mix(in oklab, var(--accent) 60%, var(--border));
    box-shadow: 0 0 0 3px var(--ring-accent);
    filter: brightness(1.02);
  }

  /* disabled / readOnly */
  [data-ui='input'][disabled],
  [data-ui='input'][aria-disabled='true'],
  [data-ui='field'] :is(input, textarea, select)[disabled],
  [data-ui='field'] :is(input, textarea, select)[aria-disabled='true'] {
    opacity: 0.6;
    cursor: not-allowed;
    background-color: color-mix(in oklab, var(--surface) 80%, var(--border));
  }

  /* helper text */
  [data-ui='field'] [data-part='hint'] {
    font-size: var(--text-xs);
    line-height: var(--text-xs--line-height);
    color: color-mix(in oklab, var(--text) 60%, transparent);
  }
  [data-ui='field'] [data-part='description'] {
    font-size: var(--text-sm);
    line-height: var(--text-sm--line-height);
    color: color-mix(in oklab, var(--text) 70%, transparent);
  }
  [data-ui='field'] [data-part='error'] {
    font-size: var(--text-sm);
    line-height: var(--text-sm--line-height);
    color: var(--color-danger);
    display: none;
  }

  /* state styling on the control */
  [data-ui='field'][data-state='success'] :is([data-ui='input'], input, textarea, select) {
    border-color: color-mix(in oklab, var(--color-positive) 60%, var(--border));
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--color-positive) 25%, transparent);
  }
  [data-ui='field'][data-state='warning'] :is([data-ui='input'], input, textarea, select) {
    border-color: color-mix(in oklab, var(--color-warning) 60%, var(--border));
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--color-warning) 25%, transparent);
  }
  [data-ui='field'][data-state='error'] :is([data-ui='input'], input, textarea, select) {
    border-color: color-mix(in oklab, var(--color-danger) 65%, var(--border));
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--color-danger) 25%, transparent);
  }

  /* show/hide error text by state */
  [data-ui='field'][data-state='error'] [data-part='error'] {
    display: block;
  }

  /* layout: inline puts label and control on one row */
  [data-ui='field'][data-layout='inline'] {
    align-items: center;
    grid-template-columns: max-content 1fr;
    column-gap: 0.75rem;
  }
  [data-ui='field'][data-layout='inline'] [data-part='label'] {
    margin-right: 0.25rem;
  }
}
